<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title>focus</title>
	<style>
	*{
		box-sizing:border-box;
	}
		#leoFocus{
			width:1000px;
			height:500px;
			border: 1px solid red;
			margin: 0 auto;
		}
	</style>
</head>
<body>
	<div id="leoFocus"></div>
	<script src="leo.js"></script>
	<script>

	/*
	this.picArr = [];
	var that = this;
	data.pics.each(function(i){
		var _pic = [
			new Image(),
			that.createPicBox(loadingImg,des);
		]
		_pic[0].src = this.pic
		that.picArr.push(_pic);
	})
	
	this.picArr.each(function(i){
		var that = this;
		this[0].onload = function(){
			l(that[1]).css({
				backgroundImage:"url(" + this.src + ")"
			})
		}
	})
	 */
		var LF = function(data){
			this.root = l.id(data.el);
			this.timer = null;//轮播定时器
			this.index = 0;
			this.interval = data.interval || 3000;
			this.speed = data.speed || 10;
			l(this.root).css({
				position:'relative',
				// overflow:'hidden'
			})

			this.wid = l(this.root).offset('Width');
			this.hei = l(this.root).offset('Height');

			this.picBox = l.create({
				tag:'div',
				style:{
					width:data.pics ? (data.pics.length + 2) * this.wid + "px" : this.wid + "px",
					height:this.hei + "px",
					position:'absolute',
					top:'0',
					left:-this.wid + "px"
				}
			})

			//将图片添加到图片盒子里
			
			var that = this;
			var picsLen = data.pics.length;
			l(this.picBox).append(this.createPicBox(data.pics[picsLen - 1].pic,data.pics[picsLen - 1].des));

			data.pics.each(function(i){
				l(that.picBox).append(that.createPicBox(this.pic,this.des || false))
			})

			l(this.picBox).append(this.createPicBox(data.pics[0].pic,data.pics[0].des))
			l(this.root).append(this.picBox);

			this.timer = setInterval(function(){
				that.next();
			},this.interval)
		}
		LF.prototype = {
			next:function(){
				this.index ++;
				var that = this;
				var timer = setInterval(function(){
					if(that.picBox.offsetLeft > -that.index * that.wid ){
						that.picBox.style.left = that.picBox.offsetLeft - that.speed + "px"
					}else{
						that.picBox.style.left = -that.index * that.wid + "px";
						clearInterval(timer);
					}
				},20)
			},
			createPicBox:function(pic,des){
				var picBox = l.create({
					tag:'div',
					style:{
						height:this.hei + "px",
						width:this.wid + "px",
						backgroundImage:"url(" + pic + ")",
						backgroundPosition:'center',
						backgroundSize:'100%',
						float:'left'
					}
				})

				if(des){
					var des = l.create({
						tag:'div',
						style:{
							backgroundColor:'rgba(0,0,0,0.4)',
							color:'white',
							padding:'10px',
							width:"100%"
						},
						content:des
					})
					l(picBox).append(des);
				}

				return picBox;
			}
		}
		var l = new LF({
			el:"leoFocus",
			pics:[
				{
					pic:'img/1.gif',
					des:'1.gif'
				},
				{
					pic:'img/10.gif',
					des:'10.gif'
				},
				{
					pic:'img/3.gif'
				}
			]
		})
	</script>
</body>
</html>